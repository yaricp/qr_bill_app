# !/bin/bash

helm upgrade qracun-test ./k8s/helm-chart --install \
-f ./k8s/helm-chart/test-values.yaml -n qracun-test --create-namespace \
--set images.api=${{ env.NAME_IMAGE_API }} \
--set images.frontend=${{ env.NAME_IMAGE_FRONTEND }} \
--set images.tg=${{ env.NAME_IMAGE_TELEGRAM_BOT }} \
--set-string config.DEBUG='${{ vars.DEBUG }}' \
--set-string config.INSTALL_DEV='${{ vars.INSTALL_DEV }}' \
--set-string config.TOKEN_EXPIRY_TIME_HOURS='${{ vars.TOKEN_EXPIRY_TIME_HOURS }}' \
--set-string config.FISCAL_SERVICE_HOSTNAME='${{ vars.FISCAL_SERVICE_HOSTNAME }}' \
--set-string config.FISCAL_SERVICE_URI='${{ vars.FISCAL_SERVICE_URI }}' \
--set-string config.FISCAL_SERVICE_API_URI='${{ vars.FISCAL_SERVICE_API_URI }}' \
--set-string config.TIME_LIFE_TEMP_LOGIN_LINK_MIN='${{ vars.TIME_LIFE_TEMP_LOGIN_LINK_MIN }}' \
--set-string config.FRONTEND_APP_LOGIN_LINK_PREFIX='${{ vars.FRONTEND_APP_LOGIN_LINK_PREFIX }}' \
--set-string config.FRONTEND_APP_VERIFY_LINK_PREFIX='${{ vars.FRONTEND_APP_VERIFY_LINK_PREFIX }}' \
--set-string config.REST_API_HOST='${{ vars.REST_API_HOST }}' \
--set-string config.REST_API_PORT='${{ vars.REST_API_PORT }}' \
--set-string config.REST_API_PREFIX='${{ vars.REST_API_PREFIX }}' \
--set-string config.REST_API_LOGIN_LINK_URI='${{ vars.REST_API_LOGIN_LINK_URI }}' \
--set-string config.REST_API_TELEGRAM_ADMIN_CHAT_ID='${{ vars.REST_API_TELEGRAM_ADMIN_CHAT_ID }}' \
--set-string config.DATABASE_DIALECT='${{ vars.DATABASE_DIALECT }}' \
--set-string config.DATABASE_DRIVER='${{ vars.DATABASE_DRIVER }}' \
--set-string config.DATABASE_ECHO='${{ vars.DATABASE_ECHO }}' \
--set-string config.DATABASE_POOL_RECYCLE='${{ vars.DATABASE_POOL_RECYCLE }}' \
--set-string config.DATABASE_POOL_PRE_PING='${{ vars.DATABASE_POOL_PRE_PING }}' \
--set-string config.DATABASE_AUTO_FLUSH='${{ vars.DATABASE_AUTO_FLUSH }}' \
--set-string config.DATABASE_EXPIRE_ON_COMMIT='${{ vars.DATABASE_EXPIRE_ON_COMMIT }}' \
--set-string config.UNICORN_HOST='${{ vars.UNICORN_HOST }}' \
--set-string config.UNICORN_PORT='${{ vars.UNICORN_PORT }}' \
--set-string config.UNICORN_LOG_LEVEL='${{ vars.UNICORN_LOG_LEVEL }}' \
--set-string config.UNICORN_RELOAD='${{ vars.UNICORN_RELOAD }}' \
--set-string config.UNICORN_WORKERS='${{ vars.UNICORN_WORKERS }}' \
--set-string config.ALLOW_ORIGINS='${{ vars.ALLOW_ORIGINS }}' \
--set-string config.ALLOW_HEADERS='${{ vars.ALLOW_HEADERS }}' \
--set-string config.ALLOW_CREDENTIALS='${{ vars.ALLOW_CREDENTIALS }}' \
--set-string config.ALLOW_METHODS='${{ vars.ALLOW_METHODS }}' \
--set-string config.PGADMIN_DEFAULT_EMAIL='${{ vars.PGADMIN_DEFAULT_EMAIL }}' \
--set-string config.TELEGRAM_LANGUAGES=${{ vars.TELEGRAM_LANGUAGES }} \
--set-string config.TELEGRAM_BOT_DEFAULT_LANG='${{ vars.TELEGRAM_BOT_DEFAULT_LANG }}' \
--set-string config.TELEGRAM_ADMIN_CHAT_ID='${{ vars.TELEGRAM_ADMIN_CHAT_ID }}' \
--set-string config.TELEGRAM_GRPC_HOST='${{ vars.TELEGRAM_GRPC_HOST }}' \
--set-string config.TELEGRAM_GRPC_PORT='${{ vars.TELEGRAM_GRPC_PORT }}' \
--set-string config.TELEGRAM_WEBAPP_ADDRESS='${{ vars.TELEGRAM_WEBAPP_ADDRESS }}' \
--set-string config.TELEGRAM_QR_PIC_DIR='${{ vars.TELEGRAM_QR_PIC_DIR }}' \
--set-string config.MASTER_EMAIL='${{ vars.MASTER_EMAIL }}' \
--set-string config.SMTP_SERVER='${{ vars.SMTP_SERVER }}' \
--set-string config.SMTP_SERVER_PORT='${{ vars.SMTP_SERVER_PORT }}' \
--set-string config.EMAIL_REPLY_TO='${{ vars.EMAIL_REPLY_TO }}' \
--set-string secrets.POSTGRES_HOST='${{ vars.DATABASE_HOST }}' \
--set-string secrets.POSTGRES_PORT='${{ vars.DATABASE_PORT }}' \
--set-string secrets.POSTGRES_USER='${{ secrets.DATABASE_USER }}' \
--set-string secrets.POSTGRES_PASSWORD='${{ secrets.DATABASE_PASSWORD }}' \
--set-string secrets.POSTGRES_DB='${{ vars.DATABASE_NAME }}' \
--set-string secrets.DATABASE_HOST='${{ vars.DATABASE_HOST }}' \
--set-string secrets.DATABASE_PORT='${{ vars.DATABASE_PORT }}' \
--set-string secrets.DATABASE_USER='${{ secrets.DATABASE_USER }}' \
--set-string secrets.DATABASE_PASSWORD='${{ secrets.DATABASE_PASSWORD }}' \
--set-string secrets.DATABASE_NAME='${{ vars.DATABASE_NAME }}' \
--set-string secrets.PGADMIN_DEFAULT_PASSWORD='${{ secrets.PGADMIN_DEFAULT_PASSWORD }}' \
--set-string secrets.TELEGRAM_BOT_TOKEN='${{ secrets.TELEGRAM_BOT_TOKEN }}' \
--set-string secrets.REST_API_TELEGRAM_BOT_TOKEN='${{ secrets.REST_API_TELEGRAM_BOT_TOKEN }}' \
--set-string secrets.SECRET_KEY='${{ secrets.SECRET_KEY }}' \
--set-string secrets.SMTP_SERVER_PASSWORD='${{ secrets.SMTP_SERVER_PASSWORD }}' \
--set-string secrets.MAILERSEND_API_KEY='${{ secrets.MAILERSEND_API_KEY }}'
